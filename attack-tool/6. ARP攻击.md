# 5 ARP攻击

> 请勿用于恶意攻击，仅限学习使用，否则后果自负

ARP（Address Resolution Protocol），中文解释为地址解析协议，是根据IP地址获取物理地址的一个TCP/IP协议。

ARP大致工作流程如下：

1 主机发送信息时将包含目标IP地址的ARP请求广播到网络上的所有主机，并接收返回消息，以此确定目标的物理地址。

2 收到返回消息后将该IP地址和物理地址存入本机ARP缓存中并保留一定时间，下次请求时直接查询ARP缓存以节约资源。

3 地址解析协议是建立在网络中各个主机互相信任的基础上的，网络上的主机可以自主发送ARP应答消息，其他主机收到应答报文时不会检测该报文的真实性就会将其记入本机ARP缓存**（重点来了，我们要利用的就是这个点！）**

![img](https://aceld.gitbooks.io/attack-tool/content/%E5%AE%89%E5%85%A837-arp.jpg)

4 攻击者可以向某一主机发送伪ARP应答报文，使其发送的信息无法到达预期的主机或到达错误的主机，这就构成了一个ARP欺骗。ARP命令可用于查询本机ARP缓存中IP地址和MAC地址的对应关系、添加或删除静态对应关系等。

![img](https://aceld.gitbooks.io/attack-tool/content/%E5%AE%89%E5%85%A838-arp.png)

## ARP攻击原理

那么 我们如何利用ARP协议来进行断网攻击呢？大致思路如下： 首先，ARP是建立在网络中各个主机互相信任的基础上的，它的诞生使得网络能够更加高效的运行，但其本身也存在缺陷：

ARP地址转换表（ARP缓存）是依赖于计算机中高速缓冲存储器动态更新的，而高速缓冲存储器的更新是受到更新周期的限制的，只保存最近使用的地址的映射关系表项，这使得攻击者有了可乘之机，可以在高速缓冲存储器更新表项之前修改地址转换表，实现攻击。

ARP请求为广播形式发送的，网络上的主机可以自主发送ARP应答消息，并且当其他主机收到应答报文时不会检测该报文的真实性就将其记录在本地的MAC地址转换表，这样攻击者就可以向目标主机发送伪ARP应答报文，从而篡改本地的MAC地址表。这就是所谓的APR欺骗攻击。

ARP欺骗可以导致目标计算机与网关通信失败，更会导致通信重定向，所有的数据都会通过攻击者的机器，因此存在极大的安全隐患，这里我们是使目标主机通信失败。

![img](https://aceld.gitbooks.io/attack-tool/content/%E5%AE%89%E5%85%A839-arp.png)

### ARP断网攻击工具

`arpspoof`

(1) 查看攻击主机网卡

```
ifconfig

```

得到eth0

------

(2) 查看目标主机ip地址和网关

```
ifconfig

```

尝试让目标主机上网。

------

(3) 攻击主机开始arp攻击 目标主机

```
arpspoof -i 攻击主机网卡 -t 目标主机IP 目标主机网关

```

------

(4) 再尝试让目标主机上网（无法上网）

------

(5) 停止攻击

尝试让目标主机上网